draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 3.5
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
#Data = rnorm(n,3.5,tau2)
#PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var)#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
set.seed(235)
draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 3.5
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
#Data = rnorm(n,3.5,tau2)
#PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var)#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var)#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var)#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
Data = rnorm(n,3.5,tau2)
PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
hist(PostDraws[,2])#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
set.seed(235)
draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 3.5
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
Data = rnorm(n,3.5,tau2)
PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(PostDraws[,2])#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
set.seed(235)
draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 3.5
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
Data = rnorm(n,3.5,tau2)
PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(PostDraws[,2])#,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
hist(var,breaks = seq(0,2,length=100)) 			# Plotting the histogram of mu-draws
hist(var,breaks = seq(1,2,length=100)) 			# Plotting the histogram of mu-draws
hist(var,breaks = seq(0,1,length=100)) 			# Plotting the histogram of mu-draws
hist(var,breaks = seq(0,3,length=100)) 			# Plotting the histogram of mu-draws
set.seed(235)
draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 3.5
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
Data = rnorm(n,3.5,tau2)
PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var,breaks = seq(0,3,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
set.seed(235)
draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 9
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
#Data = rnorm(n,3.5,tau2)
#PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var,breaks = seq(0,3,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
set.seed(235)
draws = 10000
income = c(14, 25, 45, 25, 30, 33, 19, 50, 34, 67)
n = 10
v = 9
y = log(income)
tau2=sum((y-3.5)^2)/10
tau = tau2**(0.5)
source("~/Documents/TDDE07/NormalNonInfoPrior.R")
#Data = rnorm(n,3.5,tau2)
#PostDraws<-NormalNonInfoPrior(draws,Data) # Generating 1000 draws from the joint posterior density of mu and sigma^2
var<-((n-1)*tau2)/rchisq(draws,n-1)
hist(var,breaks = seq(0,3,length=100)) 			# Plotting the histogram of mu-draws
theta = seq(0,2,length=200)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
#plot(theta,p,type="l")
hist(var,breaks = seq(0,3,length=100),freq=FALSE) 			# Plotting the histogram of mu-draws
theta = seq(0,3,length=100)
p = ((v/2)^(v/2))*(tau^v)*(theta^-((v/2)+1))*exp((-v*tau2)/(2*theta))
p = p/gamma(v/2)
lines(theta,p,col="red")
### 2 b)
set.seed(235)
### 1 a)
set.seed(235)
# Variables
s = 14
n = 20
a0 = b0 = 2
f = n - s
rand.samples = rbeta(n*100, a0 + s, b0 + f)
# True values
mean = (a0 + s) / (a0 + s + b0 + f)
variance = ((a0 + s) * (b0 + f)) / (((a0 + s) + (b0 + f))^2 * ((a0 + s) + (b0 + f) + 1))
stdev = variance^0.5
# Plots
hist(rand.samples,freq=FALSE)
x = seq(0,1,length=100)
curve(dbeta(x,a0+s,b0+f),add=TRUE,col="red")
?pnorm
G = 2*pnorm(income,0,(var**0.5/2**0.5))-1
G
G = 2*pnorm(var**0.5/2**0.5)-1
G
plot(G)
plot(100*G)
hist(G)
denisity(G)
density(G)
?quantiles
?quantile
quantile(G)
quantile(G,porbs = seq(95))
quantile(G,porbs = seq(0,95))
quantile(G,probs = seq(0,95))
quantile(G,probs = seq(0,0.95))
quantile(G,probs = seq(0,1,0.05))
quantile(G,probs = seq(0,1,0.025))
quantile(G,probs = seq(0,1,0.025))
?which
G = which(G < 0.1714136)
G = which(G > 0.1714136)
### 2 b)
set.seed(235)
G = 2*pnorm(var**0.5/2**0.5)-1
hist(G)
### 2 c)
set.seed(235)
newG = which(0.1714136 < G < 0.4396433)
newG = which(newG < 0.4396433)
newG = which(0.1714136 < G)
newG = which(newG < 0.4396433)
### 2 b)
set.seed(235)
G = 2*pnorm(var**0.5/2**0.5)-1
hist(G)
### 2 c)
set.seed(235)
quantile(G,probs = seq(0,1,0.025))
newG = which(0.1714136 < G)
newG = which(newG < 0.4396433)
newG = which(0.1714136 < G)
?which
newG = which(G > 0.1714136)
newG[which(G > 0.1714136)]
newG = G[which(G > 0.1714136)]
newG = which(newG < 0.4396433)
newG = newG[which(newG < 0.4396433)]
quantile(G,probs = seq(0,1,0.025))
newG = G[which(G > 0.1714136)]
newG = newG[which(newG < 0.4396433)]
newG
G[which(max(G))]
max(G)
max(newG)
min(G)
min(newG)
density(G)
plot(density(G))
HPDinterval(as.mcmc(G),prob = 0.95)
library(coda)
HPDinterval(as.mcmc(G),prob = 0.95)
post.temp = apply(betas[1:5000,],1,reg_fun,time = X)
data =read.delim("/home/ponsv690/Documents/TDDE07/Lab2/TempLinkoping.txt")
set.seed(235)
## 1a
Ndraws = 10000
mu_0 = t(data.frame(-15,150,-150))
Omega_0 = 1*diag(3)
nu_0 = 40
var_0 = 1
var<-(nu_0*var_0)/rchisq(Ndraws,nu_0)
hist(var,freq = FALSE)
beta = matrix(0,Ndraws,3)
library(mvtnorm)
sim.beta = function(sigma2, mu, omega){
rmvnorm(n=1,mean=mu,sigma=sigma2*solve(omega))
}
betas = sapply(var,sim.beta,mu = mu_0, omega = Omega_0)
betas = t(betas)
reg_fun =function(betas,time){
#FRÅGA!!!!!: Hur får man in epsilon i ekvationen?
temp = betas[1] + betas[2]*time + betas[3]*time^2
return(temp)
}
prior.temp = apply(betas[seq(1,25,1),],1,reg_fun, time = data$time)
x = dim(prior.temp)[1]
x.axis = (1:x) / x
#FRÅGA!!!!: Hur tätt ska kurvorna ligga varandra?
plot(x.axis,prior.temp[,1],type = "l", xlab = "Time", ylab = "Temperature",ylim=c(-20,30))
for (i in 2:25) {
lines(x.axis,prior.temp[,i])
}
## 1b
X = cbind(rep(1,length(data$time)),data$time,data$time^2)
X.prim.X = t(X)%*%X
beta.hat = solve(t(X)%*%X)%*%t(X)%*%data$temp
mu_n = solve((t(X)%*%X + Omega_0))%*%(t(X)%*%X%*%beta.hat + Omega_0%*%mu_0)
Omega_n = X.prim.X + Omega_0
nu_n = nu_0 + dim(X)[1]
nuvar_n = nu_0%*%var_0 + (t(data$temp)%*%data$temp + t(mu_0)%*%Omega_0%*%mu_0 - t(mu_n)%*%Omega_n%*%mu_n)
var_n = as.numeric(nuvar_n/nu_n)
var.post = (nu_n*var_n)/rchisq(Ndraws,nu_n)
hist(var.post) #DOES IT LOOK GOOD??
betas.post = sapply(var.post,sim.beta, mu = mu_n, omega = Omega_n)
betas.post = t(betas.post)
hist(betas[,1])
hist(betas[,2])
hist(betas[,3])
plot(data$temp)
post.temp = apply(betas[1:5000,],1,reg_fun,time = X)
post.temp = apply(betas[1:500,],1,reg_fun,time = X)
post.temp = apply(betas[1:50,],1,reg_fun,time = X)
post.temp = apply(betas.post[1:50,],1,reg_fun,time = X)
post.temp = apply(betas.post[1:25,],1,reg_fun,time = X)
View(post.temp)
post.temp = apply(betas.post[1:25,],1,reg_fun,time = data$time)
post.temp = apply(betas.post,1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:5000,],1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:Ndraws,],1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:5000,],1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:25,],1,reg_fun,time = data$time)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
median(prior.temp[,1:25])
mean(prior.temp[,1:25])
mean(prior.temp[,1])
rowMedians(prior.temp[,1])
prior.temp[,1]
prior.temp[1,]
apply(prior.temp[1,],1,median)
apply(prior.temp[1,],1,median,nr.rm=TRUE)
apply(prior.temp[1,],2,median,nr.rm=TRUE)
apply(prior.temp[,1],1,median,nr.rm=TRUE)
apply(prior.temp[1:25,],2,median,nr.rm=TRUE)
apply(prior.temp[,1:25],2,median,nr.rm=TRUE)
apply(prior.temp[,1:25],1,median,nr.rm=TRUE)
apply(prior.temp,1,median,nr.rm=TRUE)
apply(prior.temp,1,median)
post.temp.median = apply(post.temp,1,median)
line(post.temp.median)
lines(post.temp.median)
post.temp.median = apply(post.temp,1,mean)
lines(post.temp.median)
plot(data$temp)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp.median = apply(post.temp,1,median)
lines(post.temp.median)
denisty(post.temp)
densityy(post.temp)
density(post.temp)
quantile(post.temp)
?quantile
quantile(post.temp, probs = seq(0,1,0.025))
q = quantile(post.temp, probs = seq(0,1,0.025))
q
q = quantile(post.temp, probs = c(0.025,0.975))
q
q[1]
post.temp[post.temp > q[1]]
dim(post.temp)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp.median = apply(post.temp,1,median)
lines(post.temp.median)
q = quantile(post.temp, probs = c(0.025,0.975))
post.temp.median = apply(post.temp,1,median)
lines(post.temp.median)
q = quantile(post.temp, probs = c(0.025,0.975))
post.temp.q1 = post.temp[post.temp > q[1]]
post.temp.median.q1 = apply(post.temp.q1,1,median)
dim(post.temp.q1)
post.temp.q1 = post.temp[which(post.temp > q[1])]
post.temp.median.q1 = apply(post.temp.q1,1,median)
dim(post.temp.q1)
post.temp.q1
post.temp.median.q1 = post.temp.median[post.temp.median > q1]
post.temp.median.q1 = post.temp.median[post.temp.median > q]
lines(post.temp.median.q1)
post.temp.median.q1 = post.temp.median[post.temp.median > q[1]]
lines(post.temp.median.q1)
plot(data$temp)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp.median = apply(post.temp,1,median)
lines(post.temp.median)
q = quantile(post.temp, probs = c(0.025,0.975))
a = c(1,1,1)
dim(a)
post.temp.q1 = post.temp[which(post.temp > q[1]),]
post.temp.q1 = post.temp[which(post.temp[,1:1000] > q[1]),]
post.temp.q1 = post.temp[,which(post.temp[,1:1000] > q[1])]
post.temp.q1 = post.temp[which(post.temp[,1:1000] > q[1])]
post.temp.q1 = post.temp[post.temp[,1:1000] > q[1]]
post.temp[,1:1000]
post.temp.q1 = post.temp[post.temp > q[1],]
post.temp.q1 = post.temp[,post.temp > q[1]]
post.temp.q1 = apply(post.temp,1,post.temp[,post.temp > q[1]])
post.temp.q1 = apply(post.temp,1,post.temp[post.temp > q[1]])
filter = function(temp){
post.temp[,post.temp > q[1]]
}
post.temp.q1 = apply(post.temp,1,filter(post.temp))
filter = function(temp){
post.temp[post.temp > q[1]]
}
post.temp.q1 = apply(post.temp,1,filter(post.temp))
filter = function(temp){
temp[temp > q[1]]
}
post.temp.q1 = apply(post.temp,1,filter(post.temp))
post.temp.q1 = apply(post.temp,1,filter
post.temp.q1 = apply(post.temp,1,filter)
filter = function(temp){
return(temp[temp > q[1]])
}
post.temp.q1 = apply(post.temp,1,filter)
post.temp.median.q1 = apply(post.temp.q1,1,median)
lines(post.temp.q1)
View(post.temp.q1)
post.temp.q1
plot(data$temp)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp.median = apply(post.temp,1,median)
lines(post.temp.median)
filter = function(temp){
return(temp > q[1])
}
post.temp.q1 = apply(post.temp,1,filter)
post.temp.median.q1 = apply(post.temp.q1,1,median)
post.temp[post.temp > q[1]]
post.temp[post.temp > q[1],]
post.temp[(post.temp > q[1]),]
a
a=as.matrix(1,2,3;456;789)
a=as.matrix(1,2,3;4,5,6;7,8,9)
a=as.matrix(1, 3, 3)
a
a=as.matrix(1:9,ncol=3,nrow=3)
a
?as.matrix
a=as.matrix(1:9,ncol=3,nrow=3, byrow=TRUE)
a
a=as.matrix(1,ncol=3,nrow=3, byrow=TRUE)
a
a=as.matrix(1:9,ncol=3,nrow=3, byrow=TRUE)
a
a[a<4]
a[a<4,]
a[,a<4]
median(c(1,2,NA,3))
median(c(1,2,NA,3),rm.na=TRUE)
median(c(1,2,NA,3),rm.na=FALSE)
median(c(1,1,NA,3),rm.na=FALSE)
median(c(1,2,NA,3),na.rm=TRUE)
dim(post.temp)
post.temp[,1:1000]
post.temp[,1:1000] == -12
post.temp[,1:1000] < -12
a = post.temp[,1:1000] < -12
a
a = post.temp[post.temp[,1:1000] < -12]
a
a = post.temp[post.temp[,1:1000] > -12]
a
sort(post.temp)[q[1]:q[2]]
sort(post.temp)
sort(post.temp, drop=FALSE)
a = post.temp[post.temp[,1:1000] > -12,drop=FALSE]
a
a = post.temp[post.temp[,1:1000] > -12,drop=TRUE]
a
a = post.temp[post.temp[,1:1000,drop=FALSE] > -12,drop=TRUE]
a
a = apply(post.temp,1,quantile,prob = c(0.025,0.0975),na.rm=TRUE)
a
post.temp.q1 = apply(post.temp,1,quantile,prob = c(0.025,0.975),na.rm=TRUE)
a = apply(post.temp,1,quantile,prob = c(0.025,0.0975),na.rm=TRUE)
View(post.temp.q1)
post.temp.q = apply(post.temp,1,quantile,prob = c(0.025,0.975),na.rm=TRUE)
lines(post.temp.q[1])
lines(post.temp.q[,1])
lines(post.temp.q[,2])
lines(post.temp.q[1,])
lines(post.temp.q[2,])
post.temp.q = apply(post.temp,1,quantile,prob = c(0.025,0.975),na.rm=TRUE)
lines(post.temp.q[1,])
lines(post.temp.q[2,])
lines(post.temp.q[1,],col = "red")
lines(post.temp.q[2,],col = "blue")
?quantile
post.temp.q = apply(post.temp,1,quantile,probs = c(0.025,0.975),na.rm=TRUE) #How does this work??
lines(post.temp.q[1,],col = "red")
lines(post.temp.q[2,],col = "blue")
data =read.delim("/home/ponsv690/Documents/TDDE07/Lab2/TempLinkoping.txt")
set.seed(235)
## 1a
Ndraws = 10000
mu_0 = t(data.frame(-15,150,-150))
Omega_0 = 1*diag(3)
nu_0 = 40
var_0 = 1
var<-(nu_0*var_0)/rchisq(Ndraws,nu_0)
hist(var,freq = FALSE)
beta = matrix(0,Ndraws,3)
library(mvtnorm)
sim.beta = function(sigma2, mu, omega){
rmvnorm(n=1,mean=mu,sigma=sigma2*solve(omega))
}
betas = sapply(var,sim.beta,mu = mu_0, omega = Omega_0)
betas = t(betas)
reg_fun =function(betas,time){
#FRÅGA!!!!!: Hur får man in epsilon i ekvationen?
temp = betas[1] + betas[2]*time + betas[3]*time^2
return(temp)
}
prior.temp = apply(betas[seq(1,25,1),],1,reg_fun, time = data$time)
x = dim(prior.temp)[1]
x.axis = (1:x) / x
#FRÅGA!!!!: Hur tätt ska kurvorna ligga varandra?
plot(x.axis,prior.temp[,1],type = "l", xlab = "Time", ylab = "Temperature",ylim=c(-20,30))
for (i in 2:25) {
lines(x.axis,prior.temp[,i])
}
## 1b
X = cbind(rep(1,length(data$time)),data$time,data$time^2)
X.prim.X = t(X)%*%X
beta.hat = solve(t(X)%*%X)%*%t(X)%*%data$temp
mu_n = solve((t(X)%*%X + Omega_0))%*%(t(X)%*%X%*%beta.hat + Omega_0%*%mu_0)
Omega_n = X.prim.X + Omega_0
nu_n = nu_0 + dim(X)[1]
nuvar_n = nu_0%*%var_0 + (t(data$temp)%*%data$temp + t(mu_0)%*%Omega_0%*%mu_0 - t(mu_n)%*%Omega_n%*%mu_n)
var_n = as.numeric(nuvar_n/nu_n)
var.post = (nu_n*var_n)/rchisq(Ndraws,nu_n)
hist(var.post) #DOES IT LOOK GOOD??
betas.post = sapply(var.post,sim.beta, mu = mu_n, omega = Omega_n)
betas.post = t(betas.post)
hist(betas[,1])
hist(betas[,2])
hist(betas[,3])
plot(data$temp)
post.temp = apply(betas.post[1:1000,],1,reg_fun,time = data$time)
post.temp.median = apply(post.temp,1,median)
lines(post.temp.median)
post.temp.q = apply(post.temp,1,quantile,probs = c(0.025,0.975),na.rm=TRUE) #How does this work??
lines(post.temp.q[1,],col = "red")
lines(post.temp.q[2,],col = "blue")
## 1c
post.temp.q = apply(post.temp.median,1,quantile,probs = c(0.025,0.975),na.rm=TRUE) #How does this work??
post.temp.q = apply(post.temp,1,quantile,probs = c(0.025,0.975),na.rm=TRUE) #How does this work??
lines(post.temp.q[1,],col = "red")
lines(post.temp.q[2,],col = "blue")
